{"ast":null,"code":"const faunadb = require('faunadb'); // your secret hash\n\n\nconst secret = process.env.FAUNADB_SECRET_KEY;\nconst q = faunadb.query;\nconst client = new faunadb.Client({\n  secret\n});\n\nmodule.exports = async (req, res) => {\n  console.log('secret: ', secret);\n\n  try {\n    const dbs = await client.query(q.Map( // iterate each item in result\n    q.Paginate( // make paginatable\n    q.Match( // query index\n    q.Index('all_customers') // specify source\n    )), ref => q.Get(ref) // lookup each result by its reference\n    )); // ok\n\n    res.status(200).json(dbs.data);\n  } catch (e) {\n    // something went wrong\n    res.status(500).json({\n      error: e.message\n    });\n  }\n};","map":null,"metadata":{},"sourceType":"script"}